<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>DM Clinic Billing</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-50 min-h-screen pb-20">
    <div id="root"></div>

    <script type="text/babel">
        function App() {
            // LOAD SAVED DATA (The "Memory" Part)
            const [patients, setPatients] = React.useState(() => {
                const saved = localStorage.getItem('dm_clinic_income');
                return saved ? JSON.parse(saved) : [];
            });
            const [name, setName] = React.useState('');
            const [amount, setAmount] = React.useState('');

            // SAVE DATA AUTOMATICALLY
            React.useEffect(() => {
                localStorage.setItem('dm_clinic_income', JSON.stringify(patients));
            }, [patients]);

            const addEntry = () => {
                if (!name || !amount) return;
                const newEntry = {
                    id: Date.now(),
                    name: name,
                    amount: parseFloat(amount),
                    time: new Date().toLocaleTimeString('en-IN', {hour: '2-digit', minute:'2-digit'})
                };
                setPatients([newEntry, ...patients]); // Add to top
                setName('');
                setAmount('');
            };

            const clearAll = () => {
                if(confirm("Start a fresh month? This will delete all current records.")) {
                    setPatients([]);
                }
            };

            const totalIncome = patients.reduce((sum, p) => sum + p.amount, 0);

            return (
                <div class="max-w-md mx-auto relative min-h-screen">
                    
                    {/* Header */}
                    <div class="bg-blue-900 p-6 pt-12 pb-8 rounded-b-3xl shadow-lg sticky top-0 z-10">
                        <div class="flex justify-between items-center text-white mb-4">
                            <a href="index.html" class="bg-blue-800 p-2 rounded-lg opacity-80 hover:opacity-100">
                                <i data-lucide="arrow-left" class="w-5 h-5"></i>
                            </a>
                            <h1 class="font-bold text-lg">Income Tracker</h1>
                            <button onClick={clearAll} class="text-red-300 text-xs border border-red-300 px-2 py-1 rounded hover:bg-red-900">
                                Reset
                            </button>
                        </div>
                        <div class="text-center">
                            <p class="text-blue-200 text-sm mb-1">Total Collection</p>
                            <h2 class="text-4xl font-bold text-white">₹{totalIncome.toLocaleString('en-IN')}</h2>
                        </div>
                    </div>

                    {/* Input Area */}
                    <div class="px-6 -mt-6 relative z-20">
                        <div class="bg-white p-4 rounded-xl shadow-md border border-slate-100 flex gap-2">
                            <input 
                                type="text" 
                                placeholder="Patient Name" 
                                value={name}
                                onChange={(e) => setName(e.target.value)}
                                class="w-full bg-slate-50 p-3 rounded-lg border border-slate-200 outline-none focus:border-blue-500"
                            />
                            <input 
                                type="number" 
                                placeholder="₹" 
                                value={amount}
                                onChange={(e) => setAmount(e.target.value)}
                                class="w-24 bg-slate-50 p-3 rounded-lg border border-slate-200 outline-none focus:border-blue-500 font-bold text-slate-700"
                            />
                        </div>
                        <button 
                            onClick={addEntry}
                            class="w-full mt-3 bg-blue-600 text-white font-bold py-3 rounded-xl shadow-lg active:scale-95 transition-transform flex justify-center items-center gap-2">
                            <i data-lucide="plus-circle" class="w-5 h-5"></i>
                            Add Payment
                        </button>
                    </div>

                    {/* Transaction List */}
                    <div class="px-6 mt-6 pb-20 space-y-3">
                        {patients.length === 0 && (
                            <div class="text-center text-slate-400 mt-10">
                                <i data-lucide="clipboard-list" class="w-12 h-12 mx-auto mb-2 opacity-50"></i>
                                <p>No entries yet today</p>
                            </div>
                        )}
                        {patients.map(p => (
                            <div key={p.id} class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex justify-between items-center">
                                <div>
                                    <h3 class="font-semibold text-slate-800">{p.name}</h3>
                                    <p class="text-xs text-slate-400">{p.time}</p>
                                </div>
                                <span class="font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded-lg">
                                    + ₹{p.amount}
                                </span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
        lucide.createIcons();
    </script>
</body>
</html>
